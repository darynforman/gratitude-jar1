{{define "edit-form"}}
<div id="note-{{.ID}}" class="note-card glass rounded-2xl p-6 backdrop-blur-sm bg-white/10">
    <form hx-put="/notes/{{.ID}}"
          hx-target="#note-{{.ID}}"
          hx-swap="outerHTML"
          class="space-y-6">
        
        <div class="flex justify-between items-start mb-4">
            <div class="flex items-center space-x-3">
                <span class="text-3xl">{{.Emoji}}</span>
                <input type="text" 
                       name="title" 
                       value="{{.Title}}"
                       required
                       minlength="3"
                       maxlength="100"
                       class="bg-transparent border-b border-white/30 focus:border-white text-xl font-semibold text-white focus:outline-none">
                <input type="hidden" name="emoji" value="{{.Emoji}}">
            </div>
        </div>

        <textarea name="content" 
                  required
                  minlength="10"
                  maxlength="1000"
                  class="w-full bg-transparent border-b border-white/30 focus:border-white text-white/90 focus:outline-none resize-none">{{.Content}}</textarea>

        <div class="flex items-center justify-between">
            <select name="category"
                    required
                    class="bg-transparent border-b border-white/30 focus:border-white text-white/70 focus:outline-none">
                <option value="personal" {{if eq .Category "personal"}}selected{{end}}>âœ¨ Personal Growth</option>
                <option value="work" {{if eq .Category "work"}}selected{{end}}>ğŸ’¼ Work</option>
                <option value="family" {{if eq .Category "family"}}selected{{end}}>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Family</option>
                <option value="achievements" {{if eq .Category "achievements"}}selected{{end}}>ğŸ† Achievements</option>
                <option value="health" {{if eq .Category "health"}}selected{{end}}>ğŸŒ± Health</option>
                <option value="experiences" {{if eq .Category "experiences"}}selected{{end}}>ğŸŒŸ Experiences</option>
            </select>

            <div class="flex space-x-2">
                <button type="button"
                        hx-get="/gratitude/edit/{{.ID}}"
                        hx-target="#note-{{.ID}}"
                        hx-swap="outerHTML"
                        class="px-4 py-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200">
                    Cancel
                </button>
                <button type="submit"
                        class="px-4 py-2 text-white bg-white/20 hover:bg-white/30 rounded-lg transition-all duration-200">
                    Save Changes
                </button>
            </div>
        </div>

        <div class="error-message text-red-500 text-sm mt-1" data-field="title"></div>
        <div class="error-message text-red-500 text-sm mt-1" data-field="content"></div>
        <div class="error-message text-red-500 text-sm mt-1" data-field="category"></div>
    </form>
</div>

<style>
@keyframes float {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    50% { transform: translate(0, -10px) rotate(1deg); }
}

.animate-float {
    animation: float 6s ease-in-out infinite;
}

.glass {
    backdrop-filter: blur(12px);
}

.emoji-btn.active {
    background: rgba(255, 255, 255, 0.4);
    transform: scale(1.1);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const emojiButtons = document.querySelectorAll('.emoji-btn');
    const emojiInput = document.getElementById('selected-emoji');

    emojiButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Remove active class from all buttons
            emojiButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            this.classList.add('active');
            
            // Update hidden input value
            emojiInput.value = this.dataset.emoji;
        });
    });

    // Select the current emoji by default
    const currentEmoji = emojiInput.value;
    if (currentEmoji) {
        const currentButton = document.querySelector(`.emoji-btn[data-emoji="${currentEmoji}"]`);
        if (currentButton) {
            currentButton.classList.add('active');
        }
    }
});
</script>
{{end}} 