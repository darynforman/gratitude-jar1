{{define "edit-form"}}
<div id="note-{{.ID}}" class="glass rounded-2xl p-8 backdrop-blur-sm bg-white/10 animate-float">
    <div class="relative">
        <h2 class="text-3xl font-bold text-white mb-8">Edit Note</h2>
        
        <form hx-put="/gratitude/update/{{.ID}}"
              hx-target="#note-{{.ID}}"
              hx-swap="outerHTML"
              class="space-y-6">
            
            <div class="group">
                <label for="title" class="block text-sm font-medium text-white/90 mb-2">Title</label>
                <input type="text" id="title" name="title" required minlength="3" maxlength="100"
                       value="{{.Title}}"
                       class="w-full rounded-xl bg-white/20 border-0 text-white placeholder-white/50 focus:ring-2 focus:ring-white/50 py-3 px-4">
                <div class="error-message text-red-500 text-sm mt-1" data-field="title"></div>
            </div>

            <div class="group">
                <label for="content" class="block text-sm font-medium text-white/90 mb-2">Express Your Gratitude</label>
                <textarea id="content" name="content" rows="4" required minlength="10" maxlength="1000"
                          class="w-full rounded-xl bg-white/20 border-0 text-white placeholder-white/50 focus:ring-2 focus:ring-white/50 py-3 px-4">{{.Content}}</textarea>
                <div class="error-message text-red-500 text-sm mt-1" data-field="content"></div>
            </div>

            <div class="group">
                <label for="category" class="block text-sm font-medium text-white/90 mb-2">Category</label>
                <select id="category" name="category" required
                        class="w-full rounded-xl bg-white/20 border-0 text-white focus:ring-2 focus:ring-white/50 py-3 px-4">
                    <option value="">Select a category</option>
                    <option value="personal" {{if eq .Category "personal"}}selected{{end}} class="text-gray-900">âœ¨ Personal Growth</option>
                    <option value="work" {{if eq .Category "work"}}selected{{end}} class="text-gray-900">ğŸ’¼ Professional Life</option>
                    <option value="family" {{if eq .Category "family"}}selected{{end}} class="text-gray-900">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Family & Friends</option>
                    <option value="achievements" {{if eq .Category "achievements"}}selected{{end}} class="text-gray-900">ğŸ† Achievements</option>
                    <option value="health" {{if eq .Category "health"}}selected{{end}} class="text-gray-900">ğŸŒ± Health & Wellness</option>
                    <option value="experiences" {{if eq .Category "experiences"}}selected{{end}} class="text-gray-900">ğŸŒŸ Experiences</option>
                </select>
                <div class="error-message text-red-500 text-sm mt-1" data-field="category"></div>
            </div>

            <div>
                <label class="block text-sm font-medium text-white/90 mb-4">Choose an Emoji</label>
                <div class="grid grid-cols-3 sm:grid-cols-6 gap-4">
                    <button type="button" class="emoji-btn text-3xl p-3 rounded-xl bg-white/20 hover:bg-white/30 transition-all duration-300" data-emoji="âœ¨">âœ¨</button>
                    <button type="button" class="emoji-btn text-3xl p-3 rounded-xl bg-white/20 hover:bg-white/30 transition-all duration-300" data-emoji="ğŸŒŸ">ğŸŒŸ</button>
                    <button type="button" class="emoji-btn text-3xl p-3 rounded-xl bg-white/20 hover:bg-white/30 transition-all duration-300" data-emoji="ğŸ’«">ğŸ’«</button>
                    <button type="button" class="emoji-btn text-3xl p-3 rounded-xl bg-white/20 hover:bg-white/30 transition-all duration-300" data-emoji="ğŸ™">ğŸ™</button>
                    <button type="button" class="emoji-btn text-3xl p-3 rounded-xl bg-white/20 hover:bg-white/30 transition-all duration-300" data-emoji="â¤ï¸">â¤ï¸</button>
                    <button type="button" class="emoji-btn text-3xl p-3 rounded-xl bg-white/20 hover:bg-white/30 transition-all duration-300" data-emoji="ğŸŒˆ">ğŸŒˆ</button>
                </div>
                <input type="hidden" id="selected-emoji" name="emoji" value="{{.Emoji}}">
            </div>

            <div class="flex justify-end space-x-4 mt-8">
                <button type="button" 
                        hx-get="/gratitude/view/{{.ID}}"
                        hx-target="#note-{{.ID}}"
                        hx-swap="outerHTML"
                        class="px-6 py-3 rounded-xl text-white/90 hover:text-white hover:bg-white/10 transition-all duration-200">
                    Cancel
                </button>
                <button type="submit"
                        class="px-6 py-3 bg-white text-blue-600 rounded-xl font-medium hover:bg-white/90 transition-all duration-300">
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<style>
@keyframes float {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    50% { transform: translate(0, -10px) rotate(1deg); }
}

.animate-float {
    animation: float 6s ease-in-out infinite;
}

.glass {
    backdrop-filter: blur(12px);
}

.emoji-btn.active {
    background: rgba(255, 255, 255, 0.4);
    transform: scale(1.1);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const emojiButtons = document.querySelectorAll('.emoji-btn');
    const emojiInput = document.getElementById('selected-emoji');

    emojiButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Remove active class from all buttons
            emojiButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            this.classList.add('active');
            
            // Update hidden input value
            emojiInput.value = this.dataset.emoji;
        });
    });

    // Select the current emoji by default
    const currentEmoji = emojiInput.value;
    if (currentEmoji) {
        const currentButton = document.querySelector(`.emoji-btn[data-emoji="${currentEmoji}"]`);
        if (currentButton) {
            currentButton.classList.add('active');
        }
    }
});
</script>
{{end}} 